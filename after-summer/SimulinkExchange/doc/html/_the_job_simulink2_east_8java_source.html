<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SimulinkExchange: F:/CheckOut/trunk/Eclipse/plugins/SimulinkExchange/src/se/kth/md/simulinkExchange/popup/actions/atl/TheJobSimulink2East.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>F:/CheckOut/trunk/Eclipse/plugins/SimulinkExchange/src/se/kth/md/simulinkExchange/popup/actions/atl/TheJobSimulink2East.java</h1><a href="_the_job_simulink2_east_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00004"></a>00004 <span class="keyword">package </span>se.kth.md.simulinkExchange.popup.actions.atl;
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="keyword">import</span> java.io.IOException;
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="keyword">import</span> org.eclipse.core.runtime.IPath;
<a name="l00009"></a>00009 <span class="keyword">import</span> org.eclipse.core.runtime.IProgressMonitor;
<a name="l00010"></a>00010 <span class="keyword">import</span> org.eclipse.core.runtime.IStatus;
<a name="l00011"></a>00011 <span class="keyword">import</span> org.eclipse.core.runtime.Status;
<a name="l00012"></a>00012 <span class="keyword">import</span> org.eclipse.emf.common.util.URI;
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">import</span> se.kth.md.simulinkExchange.atl.ATLrunConfiguration;
<a name="l00015"></a>00015 <span class="keyword">import</span> se.kth.md.simulinkExchange.atl.URInotFound;
<a name="l00016"></a>00016 <span class="keyword">import</span> se.kth.md.simulinkExchange.atl.XmlCombiner;
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html">00018</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html">TheJobSimulink2East</a> <span class="keyword">extends</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html">TheJob</a> {
<a name="l00019"></a>00019 
<a name="l00023"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a263b12f77cbf8599de25cceae172271a">00023</a>         URI <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a263b12f77cbf8599de25cceae172271a" title="Hack for ATL bug: Cannot produce a single file from two metamodels.">umlModel1</a>;
<a name="l00024"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#aa95532a8153ee790c0736e56e4efa01b">00024</a>         URI <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#aa95532a8153ee790c0736e56e4efa01b">umlModel2</a>;
<a name="l00025"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#abcda4fe0fba4a1d1ce152dddd9f69e8f">00025</a>         URI <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#abcda4fe0fba4a1d1ce152dddd9f69e8f">resultUML</a>;
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a3e59c390c74e457a910d6e8e005b6b32">00027</a>         <span class="keyword">public</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a3e59c390c74e457a910d6e8e005b6b32">TheJobSimulink2East</a>(IPath aPath)  {
<a name="l00028"></a>00028                 super(<span class="stringliteral">&quot;Converting to EAST-ADL&quot;</span>, aPath);
<a name="l00029"></a>00029                 String atlPath = <span class="stringliteral">&quot;./resources/ATL/simulink2east.atl&quot;</span>;
<a name="l00030"></a>00030                 String asmPath = <span class="stringliteral">&quot;./resources/ATL/simulink2east.asm&quot;</span>;
<a name="l00031"></a>00031                 this.<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aa7adc2fa70b4c99ad6ec95ca70900308">initJob</a>(atlPath, asmPath);
<a name="l00032"></a>00032                 
<a name="l00033"></a>00033         }
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a01f43be74ff5b0e323b75959b7622fc8">00035</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a01f43be74ff5b0e323b75959b7622fc8">addSources</a>(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a> config) <span class="keywordflow">throws</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_u_r_inot_found.html">URInotFound</a> {
<a name="l00036"></a>00036                 <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aceb17ef5e920158bec6d766690ea0ae8">simulinkModel</a> = URI.createFileURI( <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#a05c35971aa722ebea4f7b494f9e6eb67">inModelPath</a>.toString() );
<a name="l00037"></a>00037                 config.addSource(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aceb17ef5e920158bec6d766690ea0ae8">simulinkModel</a>, <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a>.simulinkMetaModel);
<a name="l00038"></a>00038         }
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a35dd2d96011bc62dfd4623fb6dc0ea99">00040</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a35dd2d96011bc62dfd4623fb6dc0ea99">addDestination</a>(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a> config) <span class="keywordflow">throws</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_u_r_inot_found.html">URInotFound</a> {
<a name="l00041"></a>00041                 <span class="keywordtype">boolean</span> atl_Bug_cannotProduceSingleOutputFromTwoMetamodels = <span class="keyword">true</span>;
<a name="l00042"></a>00042                 <span class="keywordflow">if</span> ( atl_Bug_cannotProduceSingleOutputFromTwoMetamodels ) {
<a name="l00043"></a>00043                         <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#ac0440dc9b3c5f6548d9d15329e6ae846">useThisHackInstead</a>( config ); 
<a name="l00044"></a>00044                 } <span class="keywordflow">else</span> {
<a name="l00045"></a>00045                         <span class="comment">// Original code</span>
<a name="l00046"></a>00046                         <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aa81cae558ff5ce153ebee0787273821a">umlModel</a> = <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aceb17ef5e920158bec6d766690ea0ae8">simulinkModel</a>.trimFileExtension().appendFileExtension(<span class="stringliteral">&quot;uml&quot;</span>);
<a name="l00047"></a>00047                         config.addDestination(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aa81cae558ff5ce153ebee0787273821a">umlModel</a>, <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a>.umlMetaModel);
<a name="l00048"></a>00048                         config.addDestination(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aa81cae558ff5ce153ebee0787273821a">umlModel</a>, <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a>.eastMetaModel);
<a name="l00049"></a>00049                 }
<a name="l00050"></a>00050         }
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#ac0440dc9b3c5f6548d9d15329e6ae846">00052</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#ac0440dc9b3c5f6548d9d15329e6ae846">useThisHackInstead</a>(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a> config) <span class="keywordflow">throws</span> <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_u_r_inot_found.html">URInotFound</a> {
<a name="l00053"></a>00053                 <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a263b12f77cbf8599de25cceae172271a" title="Hack for ATL bug: Cannot produce a single file from two metamodels.">umlModel1</a> = <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aceb17ef5e920158bec6d766690ea0ae8">simulinkModel</a>.trimFileExtension().appendFileExtension(<span class="stringliteral">&quot;1.uml&quot;</span>);
<a name="l00054"></a>00054                 <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#aa95532a8153ee790c0736e56e4efa01b">umlModel2</a> = <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aceb17ef5e920158bec6d766690ea0ae8">simulinkModel</a>.trimFileExtension().appendFileExtension(<span class="stringliteral">&quot;2.uml&quot;</span>);
<a name="l00055"></a>00055                 <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#abcda4fe0fba4a1d1ce152dddd9f69e8f">resultUML</a> = <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#aceb17ef5e920158bec6d766690ea0ae8">simulinkModel</a>.trimFileExtension().appendFileExtension(<span class="stringliteral">&quot;uml&quot;</span>);
<a name="l00056"></a>00056                 config.addDestination(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a263b12f77cbf8599de25cceae172271a" title="Hack for ATL bug: Cannot produce a single file from two metamodels.">umlModel1</a>, <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a>.umlMetaModel);
<a name="l00057"></a>00057                 config.addDestination(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#aa95532a8153ee790c0736e56e4efa01b">umlModel2</a>, <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_a_t_lrun_configuration.html">ATLrunConfiguration</a>.eastMetaModel);
<a name="l00058"></a>00058         }
<a name="l00059"></a>00059         
<a name="l00063"></a>00063         @Override
<a name="l00064"></a><a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#ac10d658ab3decc00c603e452858f327f">00064</a>         <span class="keyword">protected</span> IStatus <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#ac10d658ab3decc00c603e452858f327f" title="ATL bug hack.">run</a>(IProgressMonitor monitor) {
<a name="l00065"></a>00065                 super.run(monitor);
<a name="l00066"></a>00066                 <span class="keywordflow">try</span> {
<a name="l00067"></a>00067                         <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1atl_1_1_xml_combiner.html">XmlCombiner</a>.doIt(<a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#aa95532a8153ee790c0736e56e4efa01b">umlModel2</a>, <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#a263b12f77cbf8599de25cceae172271a" title="Hack for ATL bug: Cannot produce a single file from two metamodels.">umlModel1</a>, <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job_simulink2_east.html#abcda4fe0fba4a1d1ce152dddd9f69e8f">resultUML</a>);
<a name="l00068"></a>00068                 } <span class="keywordflow">catch</span> (IOException e) {
<a name="l00069"></a>00069                         <a class="code" href="classse_1_1kth_1_1md_1_1simulink_exchange_1_1popup_1_1actions_1_1atl_1_1_the_job.html#a68daffceac71dffd838f4a365428b491">plugin</a>.log(<span class="stringliteral">&quot;Error in XmlCombiner&quot;</span>, Status.ERROR, e);
<a name="l00070"></a>00070                         <span class="keywordflow">return</span> Status.CANCEL_STATUS;
<a name="l00071"></a>00071                 }
<a name="l00072"></a>00072                 <span class="keywordflow">return</span> Status.OK_STATUS;
<a name="l00073"></a>00073         }
<a name="l00074"></a>00074 }
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Jun 21 14:46:11 2010 for SimulinkExchange by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
